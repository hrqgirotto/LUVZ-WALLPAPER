<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amor Profundo</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
    <link rel="stylesheet" href="static/styles.css">
</head>
<body>
    <!-- Conteúdo do seu HTML: título, formulário, e visualização da imagem -->
    
    <header>
        <img src="static/logo.webp" alt="Logo" class="logo">
        <h1 class="title">Leve amor por onde for, na palma da sua mão!</h1>
        <p class="subtitle">Transforme um momento especial em um wallpaper único e cheio de amor.</p>
    </header>

    <div class="floating-container">
        <img src="static/emoji/emoji-rosto-coracao-blur.webp" alt="Emoji Coração" class="emoji emoji-left">
        <img src="static/como-funciona.webp" alt="Mockup de Celular" class="floating-image">
        <img src="static/emoji/emoji-rosto-coracao.webp" alt="Emoji Coração" class="emoji emoji-right">
    </div>
    
    <div class="marquee-container">
        <div class="marquee">
            <span>CARREGUE AMOR! &nbsp; CARREGUE AMOR! &nbsp; CARREGUE AMOR! &nbsp; CARREGUE AMOR! &nbsp; CARREGUE AMOR! &nbsp; CARREGUE AMOR! &nbsp;</span>
        </div>
    </div>
    
    <div class="title-container">
        <h2 class="cta-title">
            CRIE O SEU!
            <img src="static/emoji-dedo.webp" alt="Emoji Dedo" class="emoji-icon">
        </h2>
    </div>
    

    
    <div class="main-container">
        
        <div class="form-container">
            <form id="generateForm" action="/generate" method="post" enctype="multipart/form-data">
                <!-- Seu formulário continua aqui -->
            
                <form id="generateForm" action="/generate" method="post" enctype="multipart/form-data">
                    <div class="spotify-title-container">
                        <label for="spotify_link" class="spotify-label">Link da música do Spotify:</label>
                        <button class="info-button" onclick="showTutorial()">Como pego?</button>
                    </div>
                    <input type="text" id="spotify_link" name="spotify_link" placeholder="Cole o link da música do Spotify" required>
                    

<!-- Pop-up de instruções -->
<div id="tutorialPopup" class="popup">
    <div class="popup-content">
        <span id="closePopup" class="close-popup">&times;</span>
        <h2>Como pegar o link do Spotify</h2>
        <ol>
            <li>Acesse o Spotify e escolha a música que deseja.</li>
            <li>Clique no ícone de "Compartilhar".</li>
            <li>Selecione a opção "Copiar Link".</li>
            <li>Pronto! Agora cole o link no campo.</li>
        </ol>
    </div>
</div>
                
                <div class="file-upload-container">
                    <label for="photo" class="custom-file-upload">
                        Envie sua foto
                    </label>
                    <input type="file" id="photo" name="photo" accept="image/*" required>
                    <span id="file-upload-name">Nenhum arquivo selecionado</span>
                </div>
                
                
                <label for="couple_name">Nome do casal (Opcional):</label>
                <input type="text" id="couple_name" name="couple_name" placeholder="Nome do casal">

                <label for="relationship_date">Data (Opcional):</label>
                <input type="date" id="relationship_date" name="relationship_date">

                <button type="submit" onclick="scrollToImage()">Gerar Visualização</button>
            </form>
        </div>

        <div class="image-preview" id="imagePreview">
            <h3>Veja como vai ficar em seu celular:</h3>
            <div class="generated-image-container">
                <div class="mockup-container">
                    <img src="static/celular.png" class="mockup" alt="Mockup de Celular">
                    <img id="generatedImage" src="" class="generated-image" alt="Imagem Gerada">
                    <div class="date-time">
                        <div id="currentDate" class="date"></div> <!-- Adiciona a data atual -->
                        <div id="clock" class="clock"></div> <!-- Adiciona o relógio -->
                    </div>
                </div>
            </div>
        </div>
        
                
                <img id="generatedImage" src="" alt="Imagem gerada" style="display: none;">
                <div class="loading-spinner" id="loadingSpinner" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- Modal para corte da imagem -->
    <div id="cropModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" id="closeModal">&times;</span>
            <h3>Ajuste sua imagem</h3>
            <img id="imageToCrop" src="" alt="Imagem para cortar">
            <button id="cropButton">Cortar e Usar Imagem</button>
        </div>
    </div>

    <button id="buyButton" style="display: none; position: fixed; bottom: 10px; width: 100%; background-color: #4CAF50; color: #fff; border: none; padding: 15px; font-size: 16px; text-align: center; cursor: pointer;">
        QUERO BAIXAR AGORA! — R$19,90
    </button>
    
    <div class="feedback-section">
        <div class="feedback-header">
            <div class="heart-icon left">
                <img src="static/heart-icon-left.webp" alt="Ícone de Coração Esquerdo">
            </div>
            <div class="feedback-title">
                <h2>Feedbacks</h2>
                <p>Confira os relatos de casais satisfeitos</p>
                <div class="stars">
                    ★ ★ ★ ★ ★
                </div>
                <p class="rating">4.8/5.0</p>
            </div>
            <div class="heart-icon right">
                <img src="static/heart-icon-right.webp" alt="Ícone de Coração Direito">
            </div>
        </div>
        
        <div class="carousel-container">
            <div class="carousel">
                <!-- Substitua as divs abaixo por imagens dos feedbacks -->
                <div class="carousel-item"><img src="static/feedback1.jpeg" alt="Feedback 1"></div>
                <div class="carousel-item"><img src="static/feedback2.jpeg" alt="Feedback 2"></div>
                <div class="carousel-item"><img src="static/feedback3.jpeg" alt="Feedback 3"></div>
                <div class="carousel-item"><img src="static/feedback4.jpeg" alt="Feedback 4"></div>
            </div>
            <div class="carousel-dots">
                <span class="dot"></span>
                <span class="dot"></span>
                <span class="dot"></span>
                <span class="dot"></span>
            </div>
        </div>
    </div>
    
    <div class="faq-section">
        <h2 class="faq-title">
            PERGUNTAS FREQUENTES
            <img src="static/emoji-duvida.webp" alt="Emoji Dúvida" class="emoji-duvida">
        </h2>
    
        <p>Odiamos dúvidas... resolva a sua abaixo!</p>
    
        <div class="faq-container">
            <div class="faq-item">
                <div class="faq-question" onclick="toggleAnswer(this)">
                    <span>Lorem Ipsum</span>
                    <span class="arrow">⬇</span>
                </div>
                <div class="faq-answer">
                    <p>Aqui está a resposta para a primeira pergunta do FAQ.</p>
                </div>
            </div>
    
            <div class="faq-item">
                <div class="faq-question" onclick="toggleAnswer(this)">
                    <span>Lorem Ipsum</span>
                    <span class="arrow">⬇</span>
                </div>
                <div class="faq-answer">
                    <p>Aqui está a resposta para a segunda pergunta do FAQ.</p>
                </div>
            </div>
    
            <div class="faq-item">
                <div class="faq-question" onclick="toggleAnswer(this)">
                    <span>Lorem Ipsum</span>
                    <span class="arrow">⬇</span>
                </div>
                <div class="faq-answer">
                    <p>Aqui está a resposta para a terceira pergunta do FAQ.</p>
                </div>
            </div>
    
            <div class="faq-item">
                <div class="faq-question" onclick="toggleAnswer(this)">
                    <span>Lorem Ipsum</span>
                    <span class="arrow">⬇</span>
                </div>
                <div class="faq-answer">
                    <p>Aqui está a resposta para a quarta pergunta do FAQ.</p>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
    <script>
        // Seu código JavaScript para manipulação do formulário
        const form = document.getElementById('generateForm');
        const photoInput = document.getElementById('photo');
        const cropModal = document.getElementById('cropModal');
        const imageToCrop = document.getElementById('imageToCrop');
        const cropButton = document.getElementById('cropButton');
        const spinner = document.getElementById('loadingSpinner');
        const generatedImage = document.getElementById('generatedImage');
        let cropper;

        // Mostra o modal de corte quando uma imagem é selecionada
        photoInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    imageToCrop.src = e.target.result;
                    cropModal.style.display = 'flex';

                    // Inicia o Cropper.js com a proporção de 1080x1920
                    if (cropper) {
                        cropper.destroy();
                    }
                    cropper = new Cropper(imageToCrop, {
                        aspectRatio: 1080 / 1920,
                        viewMode: 1,
                        autoCropArea: 1,
                    });
                };
                reader.readAsDataURL(file);
            }
        });

        // Fecha o modal de corte
        document.getElementById('closeModal').onclick = () => {
            cropModal.style.display = 'none';
            if (cropper) cropper.destroy();
        };

        // Recorta e envia a imagem para o servidor
        cropButton.addEventListener('click', () => {
            const canvas = cropper.getCroppedCanvas();
            canvas.toBlob((blob) => {
                const file = new File([blob], 'cropped.png', { type: 'image/png' });

                // Substitui a imagem original pela imagem recortada no formulário
                const dataTransfer = new DataTransfer();
                dataTransfer.items.add(file);
                photoInput.files = dataTransfer.files;

                cropModal.style.display = 'none';
            });
        });

        // Coloque o código fornecido aqui
        form.onsubmit = async function(event) {
            event.preventDefault();
            const formData = new FormData(this);

            // Captura os campos opcionais
            const coupleName = document.getElementById('couple_name').value;
            const relationshipDate = document.getElementById('relationship_date').value;

            // Adiciona os valores opcionais ao FormData
            formData.append('couple_name', coupleName);
            formData.append('relationship_date', relationshipDate);

            spinner.style.display = 'block';
            generatedImage.style.display = 'none';

            try {
                const response = await fetch('/generate', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    const blob = await response.blob();
                    const url = URL.createObjectURL(blob);
                    generatedImage.src = url;
                    generatedImage.style.display = 'block';
                } else {
                    alert('Erro ao gerar a imagem. Por favor, tente novamente.');
                }
            } catch (error) {
                console.error('Erro ao enviar o formulário:', error);
                alert('Ocorreu um erro ao processar a solicitação.');
            } finally {
                spinner.style.display = 'none';
            }
        };
    </script>

<script>
    function updateClock() {
        const clockElement = document.getElementById('clock');
        const now = new Date();
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        clockElement.textContent = `${hours}:${minutes}`;
    }

    // Atualiza o relógio a cada minuto
    setInterval(updateClock, 1000);
    updateClock(); // Atualiza o relógio imediatamente ao carregar

    document.addEventListener('DOMContentLoaded', function() {
    // Seleciona o botão de compra
    const buyButton = document.getElementById('buyButton');

    // Função para mostrar o botão de compra após a imagem ser gerada
    function showBuyButton() {
        buyButton.style.display = 'block';
    }

    // Verifica se a imagem gerada foi carregada
    const generatedImage = document.getElementById('generatedImage');
    generatedImage.addEventListener('load', function() {
        // Quando a imagem gerada é carregada, mostra o botão de compra
        showBuyButton();
    });
});

</script>
<script src="static/datetime.js"></script>
<script src="static/faq.js"></script>
<script src="static/scripts.js"></script>
</body>
</html>